package com.google.showcase.v1beta1.samples;

import com.google.api.gax.rpc.ApiStreamObserver;
import com.google.showcase.v1beta1.Blurb;
import com.google.showcase.v1beta1.CreateBlurbRequest;
import com.google.showcase.v1beta1.MessagingClient;
import com.google.showcase.v1beta1.ProfileName;
import com.google.showcase.v1beta1.SendBlurbsResponse;

public class SendBlurbsClientStreamingCallCreateBlurbRequest {

  public static void main(String[] args) throws Exception {
    sendBlurbsClientStreamingCallCreateBlurbRequest();
  }

  public static void sendBlurbsClientStreamingCallCreateBlurbRequest() throws Exception {
    try (MessagingClient messagingClient = MessagingClient.create()) {
      ApiStreamObserver<CreateBlurbRequest> responseObserver =
          new ApiStreamObserver<CreateBlurbRequest>() {
            @Override
            public void onNext(SendBlurbsResponse response) {
              // Do something when a response is received.
            }

            @Override
            public void onError(Throwable t) {
              // Add error-handling
            }

            @Override
            public void onCompleted() {
              // Do something when complete.
            }
          };
      ApiStreamObserver<CreateBlurbRequest> requestObserver =
          messagingClient.sendBlurbs().clientStreamingCall(responseObserver);
      CreateBlurbRequest request =
          CreateBlurbRequest.newBuilder()
              .setParent(ProfileName.of("[USER]").toString())
              .setBlurb(Blurb.newBuilder().build())
              .build();
      requestObserver.onNext(request);
    }
  }
}
